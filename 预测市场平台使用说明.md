# 🎯 预测市场平台使用说明

## 📋 概述

这是一个完整的预测市场平台，支持用户自由交易和管理员管理功能。与之前的步骤演示不同，这是一个真实的预测市场系统。

## 🚀 快速开始

### 启动平台
```bash
./start_platform.sh
```

### 访问地址
- **主平台**: http://localhost:8000/prediction_market_platform.html
- **旧演示**: http://localhost:8000/interactive_demo.html

## 👤 用户功能

### 登录
1. 在"用户登录"区域输入任意钱包地址
2. 点击"用户登录"按钮
3. 系统会自动显示用户信息面板

### 主要功能

#### 📊 市场列表
- 查看所有活跃的预测市场
- 显示市场问题、状态、代币数量
- 可以查看市场详情和进行交易

#### 💹 交易中心
- 选择市场进行交易
- 买入/卖出YES或NO代币
- 实时价格显示
- 交易记录追踪

#### 📈 我的资产
- 查看USDC余额
- 查看YES/NO代币持有量
- 资产价值统计
- 投资盈亏分析

#### 💰 USDC领取
- 点击"领取1000 USDC"按钮
- 从管理员地址自动转账
- 实时更新余额

## 👨‍💼 管理员功能

### 登录
1. 在"管理员登录"区域输入密码: `admin123`
2. 点击"管理员登录"按钮
3. 系统会显示管理员权限面板

### 主要功能

#### 🏗️ 创建市场
1. 在管理面板的"创建新市场"区域
2. 输入市场问题（如："比特币价格明天会涨吗？"）
3. 点击"创建市场"按钮
4. 系统自动：
   - 向CTF合约转入2000 USDC作为抵押品
   - 铸造1000个YES代币和1000个NO代币
   - 注册代币到Exchange
   - 保存市场信息到数据库

#### ⚙️ 市场管理
1. 选择要管理的市场
2. 选择结果（YES获胜/NO获胜）
3. 点击"设置结果"按钮
4. 系统会更新市场状态

#### 📊 系统状态
- 查看API服务状态
- 查看市场总数
- 监控系统运行情况

## 🔧 技术特性

### 真实链上合约
- 使用HashKey测试网智能合约
- 真实的USDC转账和代币铸造
- 真实的交易哈希记录
- 链上数据持久化

### 数据持久化
- 市场数据自动保存到 `markets_data.json`
- 服务器重启后自动加载历史数据
- 完整的交易记录追踪

### API接口
- `GET /api/markets` - 获取所有市场
- `GET /api/markets/:marketId` - 获取特定市场
- `POST /api/create-market` - 创建新市场
- `POST /api/claim-usdc` - 领取USDC
- `GET /api/balance/:address` - 查询余额

## 📱 界面说明

### 登录区域
- **用户登录**: 输入钱包地址即可登录
- **管理员登录**: 需要密码验证

### 用户信息面板
- 显示USDC、YES、NO代币余额
- 提供USDC领取和退出登录功能

### 标签页导航
- **📊 市场列表**: 查看所有活跃市场
- **💹 交易中心**: 进行代币交易
- **📈 我的资产**: 查看资产详情
- **⚙️ 管理面板**: 管理员专用功能

### 交易记录
- 实时显示所有操作记录
- 包含时间戳和详细信息
- 自动限制显示最近20条记录

## 🎯 使用场景

### 用户场景
1. **浏览市场**: 查看所有可交易的预测市场
2. **分析市场**: 了解市场问题和当前状态
3. **进行交易**: 买入或卖出YES/NO代币
4. **管理资产**: 查看投资组合和盈亏情况

### 管理员场景
1. **创建市场**: 根据热点事件创建新的预测市场
2. **监控系统**: 查看系统状态和市场数量
3. **设置结果**: 当事件结果确定后，设置市场结果
4. **用户支持**: 协助用户解决交易问题

## 🔍 与旧演示的区别

| 特性 | 旧演示 | 新平台 |
|------|--------|--------|
| **交互方式** | 步骤式演示 | 自由交易平台 |
| **用户角色** | 单一用户流程 | 用户/管理员双角色 |
| **市场管理** | 固定市场 | 动态创建市场 |
| **交易方式** | 模拟交易 | 真实链上交易 |
| **数据持久化** | 临时数据 | 永久保存 |
| **界面设计** | 演示导向 | 产品导向 |

## 🛠️ 故障排除

### 常见问题

1. **无法访问平台**
   - 检查API服务器是否运行: `curl http://localhost:3001/api/health`
   - 检查Web服务器是否运行: `curl http://localhost:8000`

2. **登录失败**
   - 用户登录: 确保输入有效的钱包地址格式
   - 管理员登录: 密码必须是 `admin123`

3. **交易失败**
   - 检查网络连接
   - 确认有足够的USDC余额
   - 查看交易记录中的错误信息

4. **市场不显示**
   - 刷新页面
   - 检查API服务器状态
   - 查看浏览器控制台错误

### 重启服务
```bash
# 停止所有服务
pkill -f 'node usdc_api.js'
pkill -f 'python3 -m http.server'

# 重新启动
./start_platform.sh
```

## 📊 系统要求

- **Node.js**: 用于API服务器
- **Python 3**: 用于Web服务器
- **现代浏览器**: 支持ES6+和Fetch API
- **网络连接**: 访问HashKey测试网

## 🎉 总结

这个预测市场平台提供了完整的预测市场功能，包括：

- ✅ 用户自由交易
- ✅ 管理员市场管理
- ✅ 真实链上合约
- ✅ 数据持久化
- ✅ 现代化界面
- ✅ 完整的API接口

现在您可以向领导展示一个真正的预测市场产品，而不是简单的演示！


