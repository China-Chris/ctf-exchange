# 🔗 Web3钱包连接使用说明

## 📋 概述

预测市场平台现在支持Web3钱包真实登录，用户可以使用MetaMask等Web3钱包直接连接，无需手动输入地址。

## 🚀 快速开始

### 启动平台
```bash
./start_platform.sh
```

### 访问地址
- **主平台**: http://localhost:8000/prediction_market_platform.html

## 🔗 Web3钱包连接

### 支持的钱包
- **MetaMask** (推荐)
- **WalletConnect**
- **Coinbase Wallet**
- **其他支持EIP-1193的钱包**

### 连接步骤

#### 1. 安装MetaMask
如果还没有安装MetaMask：
1. 访问 [MetaMask官网](https://metamask.io/)
2. 下载并安装浏览器扩展
3. 创建或导入钱包

#### 2. 连接钱包
1. 打开预测市场平台
2. 点击"连接钱包"按钮
3. MetaMask会弹出连接请求
4. 点击"连接"确认连接
5. 系统会自动显示钱包信息

#### 3. 钱包信息显示
连接成功后，页面会显示：
- **钱包地址**: 显示前6位和后4位
- **网络信息**: 显示当前连接的网络
- **断开连接**: 可以随时断开钱包连接

## 🎯 平台功能

### 进入即见市场列表
- 打开网站即可看到所有预测市场
- 无需登录即可浏览市场信息
- 连接钱包后可进行交易

### 用户功能（连接钱包后）
- **📊 市场列表**: 查看所有预测市场
- **💹 交易中心**: 买入/卖出YES/NO代币
- **📈 我的资产**: 查看USDC和代币余额
- **💰 USDC领取**: 从管理员地址领取测试USDC

### 管理员功能
- **🏗️ 创建市场**: 创建新的预测市场
- **⚙️ 设置结果**: 设置市场结果
- **📊 系统监控**: 查看系统状态

## 🔧 技术特性

### Web3集成
- **ethers.js v6**: 使用最新的ethers.js库
- **EIP-1193**: 标准Web3钱包接口
- **自动重连**: 页面刷新后自动检测已连接的钱包
- **事件监听**: 监听账户和网络变化

### 安全特性
- **真实签名**: 所有交易都需要钱包签名
- **地址验证**: 自动验证钱包地址格式
- **网络检测**: 检测当前连接的网络
- **权限控制**: 区分用户和管理员权限

## 📱 界面说明

### 连接前
- 显示"连接钱包"按钮
- 如果未安装MetaMask，显示安装提示

### 连接后
- 显示钱包地址和网络信息
- 显示"断开连接"按钮
- 激活用户功能面板

### 市场列表
- 默认显示所有预测市场
- 包含市场问题、状态、代币数量
- 支持查看详情和交易操作

## 🛠️ 故障排除

### 常见问题

1. **无法连接钱包**
   - 确保已安装MetaMask或其他Web3钱包
   - 检查钱包是否已解锁
   - 刷新页面重试

2. **连接后无反应**
   - 检查浏览器控制台错误
   - 确保钱包已授权网站访问
   - 尝试断开重连

3. **网络不匹配**
   - 确保钱包连接到正确的网络
   - 平台支持HashKey测试网
   - 可以手动切换网络

4. **交易失败**
   - 检查钱包余额是否充足
   - 确认网络连接正常
   - 查看交易记录中的错误信息

### 调试信息
打开浏览器开发者工具（F12）查看：
- 控制台错误信息
- 网络请求状态
- 钱包连接状态

## 🔍 与旧版本的区别

| 特性 | 旧版本 | 新版本 |
|------|--------|--------|
| **登录方式** | 手动输入地址 | Web3钱包连接 |
| **市场显示** | 需要登录后显示 | 进入即见 |
| **交易签名** | 模拟签名 | 真实钱包签名 |
| **地址管理** | 手动输入 | 自动获取 |
| **网络检测** | 无 | 自动检测 |
| **账户切换** | 无 | 自动监听 |

## 📊 支持的交易

### 代币交易
- **买入YES代币**: 使用USDC购买YES代币
- **买入NO代币**: 使用USDC购买NO代币
- **卖出YES代币**: 将YES代币兑换为USDC
- **卖出NO代币**: 将NO代币兑换为USDC

### 市场操作
- **查看市场详情**: 了解市场问题和状态
- **参与交易**: 根据预测进行投资
- **管理资产**: 查看投资组合

## 🎉 总结

Web3钱包连接功能使预测市场平台更加真实和用户友好：

- ✅ 真实钱包连接
- ✅ 进入即见市场
- ✅ 自动地址管理
- ✅ 真实交易签名
- ✅ 网络状态检测
- ✅ 账户变化监听

现在用户可以像使用真正的DeFi应用一样使用预测市场平台！


